{"version":3,"sources":["webpack:///./src/pages/content/integration/onprem-offline.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-content-integration-onprem-offline-md-39dad59f742f014bccd6.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/Shared/VBDData/programs/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#introduction\"\n        }}>{`Introduction`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#prepare-for-installation\"\n        }}>{`Prepare For Installation`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#run-the-integration-cloud-pak-install\"\n        }}>{`Run the Integration Cloud Pak install`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#deploy-capabilities\"\n        }}>{`Deploy Capabilities`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#example-files\"\n        }}>{`Example files`}</a><ul parentName=\"li\">\n          <li parentName=\"ul\"><a parentName=\"li\" {...{\n              \"href\": \"#configyaml\"\n            }}>{`config.yaml`}</a></li>\n        </ul></li>\n    </ul>\n    <h2>{`Introduction`}</h2>\n    <p>{`This page describes all the steps on how to deploy the Integration Cloud Pak to a VMWARE onprem environment using the IBM Entitled registry. The steps below includes instructions to:\n1. Prepare the bastion node for installation\n2. Run the Integration Cloud Pak installer to deploy to an existing OpenShift cluster`}</p>\n    <h2>{`Prepare For Installation`}</h2>\n    <p>{`In many production scenarios the master nodes may not be accessed via ssh, we have to choose bastion node to proceed with the installation. `}</p>\n    <p><strong parentName=\"p\">{`Installer Node requirements:`}</strong>{`  `}</p>\n    <ul>\n      <li parentName=\"ul\">{`Sufficient resources of `}<inlineCode parentName=\"li\">{`4cpu 16GB ram ~120 GB Diskspace`}</inlineCode></li>\n      <li parentName=\"ul\">{`OpenShift CLI, which can be installed following the instruction `}<a parentName=\"li\" {...{\n          \"href\": \"https://cloud.ibm.com/docs/openshift?topic=openshift-openshift-cli\"\n        }}>{`here on IBM Cloud`}</a>{`.`}</li>\n      <li parentName=\"ul\">{`Install Docker (v2.2 is compliant and works with Open Shift)`}</li>\n      <li parentName=\"ul\">{`Install Kubernetes CLI kubectl `}</li>\n    </ul>\n    <p>{`Once the CLIs are installed, check if you can login to openshift environment:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Get login token from openshift console`}</li>\n      <li parentName=\"ol\">{`Run the `}<inlineCode parentName=\"li\">{`oc login`}</inlineCode>{` command from a terminal shell.`}</li>\n      <li parentName=\"ol\">{`You should see the cluster logged in message along with list of projects.`}</li>\n    </ol>\n    <p><strong parentName=\"p\">{`Installing on Master or Infra node:`}</strong><br parentName=\"p\"></br>{`\n`}{`The value of the master, proxy, and management parameters is an array and can have multiple nodes. Due to a limitation from OpenShift, if you want to deploy IBM Cloud Private on any OpenShift master or infrastructure node, you must label the node as an OpenShift compute node with the following command:  `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`oc label node &lt;master node host name/infrastructure node host name> node-role.kubernetes.io/compute=true\n`}</code></pre>\n    <h2>{`Run the Integration Cloud Pak install`}</h2>\n    <p>{`Integration Cloud Pak provides a single installer that installs ICP as well loads all the helm charts for integration capabilities. In this example CP4I will be installed on the master node.`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Download Integration Cloud Pak installer on the installer node. See `}<a parentName=\"li\" {...{\n          \"href\": \"../pre-reqs\"\n        }}>{`Pre-requisites`}</a>{` for guidance.\n`}</li>\n      <li parentName=\"ol\">{`Open a command line window on the boot node, and extract the contents of the Cloud Pak. It is a general recommendation to create a directory in /opt and extract into that directory:  `}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`tar xf ibm-cp-int-2019.4.1-online.tar.gz --directory /opt/cp4i\n`}</code></pre>\n    <p>{`Once untarred, you can navigate to the directory where the packages was untarred to and type `}<inlineCode parentName=\"p\">{`tree`}</inlineCode>{`.  It will look like the below`}</p>\n    <img {...{\n      \"src\": \"1.untar-cp4i.png\",\n      \"alt\": null\n    }}></img>\n    <ol {...{\n      \"start\": 3\n    }}>\n      <li parentName=\"ol\">{`Load the images onto your local docker registry:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`sudo docker load -i installer_files/cluster/images/icp-inception-3.2.2.tgz\n`}</code></pre>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Change to the `}<inlineCode parentName=\"li\">{`installer_files/cluster/`}</inlineCode>{` directory. Place the cluster configuration files (kubeconfig) in the `}<inlineCode parentName=\"li\">{`installer_files/cluster/`}</inlineCode>{` directory. You can also use the following command after using oc login as admin.  Make sure your file only has one cluster context defined with in it, and that context is the location of your target cluster.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`oc config view > kubeconfig\n`}</code></pre>\n    <ol {...{\n      \"start\": 4\n    }}>\n      <li parentName=\"ol\">{`Note down the IP addresses of OpenShift worker nodes. To get the IP addresses of the worker nodes, run:`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`oc get nodes -o wide\n`}</code></pre>\n    <ol {...{\n      \"start\": 5\n    }}>\n      <li parentName=\"ol\">{`Navigate to your cluster directory `}<inlineCode parentName=\"li\">{`/opt/cp4i/installer/cluster`}</inlineCode>{`.  `}</li>\n      <li parentName=\"ol\">{`Edit the config.yaml with the information you have collected above. See the example at the end of the page for guidance.`}</li>\n    </ol>\n    <p>{`Here are the fields to update with your respective values based on your environment:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`under cluster_nodes heading -> set the hostnames for `}<inlineCode parentName=\"li\">{`Master`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`Proxy`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`Management`}</inlineCode>{`.  For non-prdoduction type system, setting and proxy to the same host is fine.  use the short name for your nodes (e.g. compute1, compute2 etc)`}</li>\n      <li parentName=\"ul\">{`under storage_class -> choose your default storage class here - use `}<inlineCode parentName=\"li\">{`oc get sc`}</inlineCode>{` to get a list of available storageclasses.`}</li>\n      <li parentName=\"ul\">{`docker_user -> `}<inlineCode parentName=\"li\">{`ekey`}</inlineCode></li>\n      <li parentName=\"ul\">{`docker_password -> set this to your entitlement key`}</li>\n    </ul>\n    <p>{`instructions to get your entitlement key can be found `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.ibm.com/CloudPakOpenContent/cloudpak-entitlement\"\n      }}>{`here`}</a>{` `}</p>\n    <ol {...{\n      \"start\": 9\n    }}>\n      <li parentName=\"ol\">{`Run the installer with:`}<pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`sudo docker run -t --net=host -e LICENSE=accept -v $(pwd):/installer/cluster:z -v /var/run:/var/run:z -v /etc/docker:/etc/docker:z --security-opt label:disable ibmcom/icp-inception-amd64:3.2.2 addon -vvv | tee install.log\n`}</code></pre></li>\n      <li parentName=\"ol\">{`If the namespaces for the different capabilities did not create you can create them manually using the scripts in `}<inlineCode parentName=\"li\">{`installer_files/cluster/resources`}</inlineCode>{` e.g. ace.yaml, apic.yaml.  Simply run each script using this syntax`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`oc create -f &lt;scriptname>.yaml\n`}</code></pre>\n    <ol {...{\n      \"start\": 9\n    }}>\n      <li parentName=\"ol\">{`Once the process is complete, you will need to create your `}<inlineCode parentName=\"li\">{`ibm_entitlement_key`}</inlineCode>{` secrets in all of the main component namespaces.  You can accomplish this by running the `}<inlineCode parentName=\"li\">{`create_secrets.sh`}</inlineCode>{` script. Before doing so, export these two variables`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`export DOCKER_REGISTRY_USER=ekey\nexport DOCKER_REGISTRY_PASS=&lt;your entitlement key>\n`}</code></pre>\n    <ol {...{\n      \"start\": 10\n    }}>\n      <li parentName=\"ol\">{`It will be helpful to understand what your proxy node address is, as it will be referenced several time when deploying the individual capabilities.  Run this command and take note of its output.`}</li>\n    </ol>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-md\"\n      }}>{`oc get configmap -n kube-public ibmcloud-cluster-info -o=jsonpath=\"{.data.proxy_address}\"\\`\n`}</code></pre>\n    <h2>{`Deploy Capabilities`}</h2>\n    <p>{`It is recommended that you install the tracing capability first`}</p>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-tracing\"\n        }}>{`Tracing`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-integration\"\n        }}>{`App Connect`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-api-mgmt\"\n        }}>{`API Connect`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-queue-manager\"\n        }}>{`MQ`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-eventstreams\"\n        }}>{`Event Streams`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-fast-file-transfer\"\n        }}>{`Aspera`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-secure-gateway\"\n        }}>{`DataPower`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"../deploy-asset-repo\"\n        }}>{`Asset Repository`}</a></li>\n    </ul>\n    <h2>{`Example files`}</h2>\n    <p>{`This section contains examples of files you will be using throughout the installation. Refer to them for guidance on how to populate your own version of the files.`}</p>\n    <h3>{`config.yaml`}</h3>\n    <pre><code parentName=\"pre\" {...{}}>{`# Nodes selected to run common services components.\n#\n# The value of the master, proxy, and management parameters is an array,\n# by providing multiple nodes the common services will be configured in\n# a high availability configuration.\n#\n# It is recommended to install the components onto one or more openshift\n# worker nodes. The master, proxy, and management components can all share\n# the same node or set of nodes.\ncluster_nodes:\n  master:\n    - compute1\n  proxy:\n    - compute1\n  management:\n    - compute2\n# This storage class is used to store persistent data for the common services\n# components\nstorage_class: csi-cephfs\n## You can set a different storage class for storing log data.\n## By default it will use the value of storage_class.\n# elasticsearch_storage_class:\n# These settings enable the installer to install common services from the IBM\n# Entitled Registry. You will need to supply your entitlement key as described\n# at https://github.com/ibm/charts\nprivate_registry_enabled: true\nimage_repo: cp.icr.io/cp/icp-foundation\ndocker_username: ekey\ndocker_password: &lt;your_entitlement_key>\ndefault_admin_password: admin\npassword_rules:\n  - '(.*)'\nmanagement_services:\n  # Common services\n  iam-policy-controller: enabled\n  metering: enabled\n  licensing: disabled\n  monitoring: enabled\n  nginx-ingress: enabled\n  common-web-ui: enabled\n  catalog-ui: enabled\n  mcm-kui: enabled\n  logging: enabled\n  audit-logging: disabled\n  system-healthcheck-service: disabled\n  multitenancy-enforcement: disabled\n  configmap-watcher: disabled\n# This section installs the IBM Cloud Pak for Integration Platform Navigator.\n# The navigator will be available after installation at:\n# https://ibm-icp4i-prod-integration.&lt;openshift apps domain>/\narchive_addons:\n  icp4i:\n    namespace: integration\n    repo: local-charts\n    path: icp4icontent/IBM-Cloud-Pak-for-Integration-3.0.0.tgz\n    charts:\n      - name: ibm-icp4i-prod\n        values: {}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}