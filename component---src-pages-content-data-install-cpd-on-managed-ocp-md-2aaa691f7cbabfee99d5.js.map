{"version":3,"sources":["webpack:///./src/pages/_content/data/install-CPD-on-managed-OCP.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"2eAMO,IAAMA,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,4EACA,6FACA,0BAAS,mBAAGC,WAAW,KAAQ,CAC3B,KAAQ,yHADH,4EAGT,oLACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,0JAIL,iDACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,+BAEL,uEACA,8FACA,mJAMA,oIACA,8JAMA,2FACA,+IAMA,mEACA,kKAMA,0JACA,mKAMA,2DACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,wBAEL,6GACA,+IAMA,yDACA,+PACA,4FACA,0HACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,6PAUL,uDACA,0EACA,6CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,2sCAYL,sCACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,6EAGL,4EACA,8CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,k6BAeL,sCACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,+FAEL,sEACA,8CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,uyBAWL,uCACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,8EAEL,8DACA,4CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,0mCAOL,sCACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,mCAEL,uFACA,4CACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,2kCAeL,sCACA,0GACA,0BAAS,mBAAGA,WAAW,KAAQ,CAC3B,KAAQ,oGADH,kBAObJ,EAAWK,gBAAiB","file":"component---src-pages-content-data-install-cpd-on-managed-ocp-md-2aaa691f7cbabfee99d5.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/Shared/VBDData/programs/cloudpak8s/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Create installation script and run it in terminal.`}</h2>\n    <p>{`1 Copy the content of install-cp4data.sh from IBM Knowledge Center: `}</p>\n    <p>{`  `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.ibm.com/support/knowledgecenter/en/SSQNUZ_2.1.0/com.ibm.icpdata.doc/zen/install/openshift-softlayer.html\"\n      }}>{`Installing Cloud Pak for Data on managed Red Hat OpenShift on IBM Cloud`}</a></p>\n    <p>{`2 Change the content of DOCKER-REGISTRY related parameters and here is an example in IBM Cloud environment (password is not provided for security reason): `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`DOCKER_REGISTRY=\"us.icr.io/release2_1_0_1_base\"\nDOCKER_REGISTRY_USER=\"iamapikey\"\nDOCKER_REGISTRY_PASS=\"&lt;&lt;inform here the docker password>>\"\n`}</code></pre>\n    <p>{` 3 Run the shell script:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`./install-cp4data.sh zen\n`}</code></pre>\n    <h2>{`Start CPD deployment in Openshift webconsole.`}</h2>\n    <p>{`  1 In the OpenShift container platform, go to the created namespace.`}</p>\n    <p>{`  {%\ninclude figure.html\nsrc=“/assets/img/cp4d/ocp-name-space.jpg”\nalt=“Go to Namespace”\ncaption=“Go to Namespace”\n%}`}</p>\n    <p>{`  2 Click Select from Project. Alternatively, you can go to the Catalog Menu and select Cloud Pak for Data.`}</p>\n    <p>{`{%\ninclude figure.html\nsrc=“/assets/img/cp4d/select-from-project.jpg”\nalt=“Select From Project”\ncaption=“Select From Project”\n%}`}</p>\n    <p>{`  3 In the Selection window, click Cloud Pak for Data. Click Next.`}</p>\n    <p>{`{%\ninclude figure.html\nsrc=“/assets/img/cp4d/select-cpd.jpg”\nalt=“Selection Window”\ncaption=“Selection Window”\n%}`}</p>\n    <p>{`  4 In the Information window, click Next.`}</p>\n    <p>{`  {%\ninclude figure.html\nsrc=“/assets/img/cp4d/information-window-next.jpg”\nalt=“Information Window”\ncaption=“Information Window”\n%}`}</p>\n    <p>{`  5 In the Configuration window, fill in your cluster environment information. Ensure the StorageClass is correct. Click Create. `}</p>\n    <p>{`  {%\ninclude figure.html\nsrc=“/assets/img/cp4d/configuration-window.jpg”\nalt=“Configuration Window”\ncaption=“Configuration Window”\n%}`}</p>\n    <p>{`  Here is an example StorageClass:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`   ibmc-file-gold\n`}</code></pre>\n    <p>{`  6 In the Results window, click Continue on the project overview to see the status.`}</p>\n    <p>{`{%\ninclude figure.html\nsrc=“/assets/img/cp4d/results-window.jpg”\nalt=“Results Window”\ncaption=“Results Window”\n%}`}</p>\n    <h2>{`Monitor the deployment process.`}</h2>\n    <p>{`  1 Keep monitoring the log of deployment. In a correct order, first step will be deploying pod: “cp4data-installer-1-sp28b” and then you can view the log of the this pod to monitor the process the all the other components of CPD.`}</p>\n    <p>{`  2 Use command “oc get pods” to check the status in the terminal. `}</p>\n    <p>{`  3 it may take up to 2 hours to finish the deployment and finally you will have 83 pods running!`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` qijuns-mbp:OCP qijunwang$ oc get pods -n zen | wc -l\n  \n 84\n \n qijuns-mbp:OCP qijunwang$ oc get pods -n zen | grep -v Running | grep -v Completed\n \n NAME                   READY     STATUS    RESTARTS   AGE\n  \n qijuns-mbp:OCP qijunwang$ \n`}</code></pre>\n    <h2>{`Known issues and resolutions.`}</h2>\n    <p>{`   1  Failed to pull images from Docker REGISTRY.`}</p>\n    <p>{`   Log of the error:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` 2:08:36 PM     cp4data-installer-1-87cmn     Pod     Warning     Failed      Error: ImagePullBackOff\n 3 times in the last minute\n 2:08:36 PM     cp4data-installer-1-87cmn     Pod     Normal     Back-off      Back-off pulling image \"cp.stg.icr.io/cp /cp4d/cp4d-installer:v1\"\n 3 times in the last minute\n 2:08:22 PM     cp4data-installer-1-87cmn     Pod     Warning     Failed      Failed to pull image \"cp.stg.icr.io/cp/cp4d/cp4d-installer:v1\": rpc error: code = Unknown desc = unable to retrieve auth token: invalid username/password\n 3 times in the last minute\n 2:08:22 PM     cp4data-installer-1-87cmn     Pod     Warning     Failed      Error: ErrImagePull\n 3 times in the last minute\n 2:08:22 PM     cp4data-installer-1-87cmn     Pod     Normal     Pulling      pulling image \"cp.stg.icr.io/cp/cp4d/cp4d-installer:v1\"\n 3 times in the last minute\n2:07:27 PM     cp4data-installer-1-87cmn     Pod     Warning     Failed Create Pod Sand Box      Failed create pod sandbox: rpc error: code = Unknown desc = failed to create pod network sandbox k8s_cp4data-installer-1-87cmn_zen_d412daf1-cf3e-11e9-bd0c-2a0a29181891_0(be9ae5031560dc694d70d4d0e41c52e1b95832493b99efef92ce168251d80581): context deadline exceeded\n`}</code></pre>\n    <p>{`  Resolution:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` Change the Docker Registry URL to \"us.icr.io/release2_1_0_1_base\".\n \n`}</code></pre>\n    <p>{`  2  Stuck by “services “ibm-nginx-svc” not found”.`}</p>\n    <p>{`   Log of the error: `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` installctl/cmd.glob..func3(0x2978720, 0xc0001a22a0, 0x0, 0xe)\n/root/go/src/github.ibm.com/privatecloud/installctl/cmd/deploy.go:39 +0x20\ngithub.com/spf13/cobra.(*Command).execute(0x2978720, 0xc0001a21c0, 0xe, 0xe, 0x2978720, 0xc0001a21c0)\n/root/go/pkg/mod/github.com/spf13/cobra@v0.0.0-20190805155617-b80588d523ec/command.go:833 +0x2ae\ngithub.com/spf13/cobra.(*Command).ExecuteC(0x2978c20, 0x4, 0x17e2509, 0x32)\n/root/go/pkg/mod/github.com/spf13/cobra@v0.0.0-20190805155617-b80588d523ec/command.go:917 +0x2fc\ngithub.com/spf13/cobra.(*Command).Execute(...)\n/root/go/pkg/mod/github.com/spf13/cobra@v0.0.0-20190805155617-b80588d523ec/command.go:867\ninstallctl/cmd.Execute()\n/root/go/src/github.ibm.com/privatecloud/installctl/cmd/root.go:38 +0x32\nmain.main()\n/root/go/src/github.ibm.com/privatecloud/installctl/main.go:34 +0x20\nNo resources found.\nError from server (NotFound): services \"ibm-nginx-svc\" not found\n`}</code></pre>\n    <p>{`  Resolution:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`Restart the pod: \"cp4data-installer\" by \"oc delete\" in terminal or Openshift webconsole.\n`}</code></pre>\n    <p>{` 3 Stuck by “unbound PersistentVolumeClaims”.`}</p>\n    <p>{`   Log of the error: `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` time=\"2019-09-04T19:35:03Z\" level=info msg=\"Release present on the cluster in DEPLOYED state. Upgrading...\"\n time=\"2019-09-04T19:35:03Z\" level=info msg=\"Upgrading release zen-0005-boot\"\n time=\"2019-09-04T19:35:04Z\" level=info msg=\"Release Deployment Status: zen-0005-boot - Deploy: -1/1 - Pod: 0/0 - Job: 0/0 - Pvc: 0/1\"\n time=\"2019-09-04T19:35:05Z\" level=info msg=\"Release Deployment Status: zen-0005-boot - Deploy: 0/1 - Pod: 0/1 - Job: 0/0 - Pvc: 0/1\"\n no error or warning, but no progress.\nEvents:\n Type     Reason            Age                     From               Message\n ----     ------            ----                    ----               -------\n Warning  FailedScheduling  2m15s (x25 over 3m18s)  default-scheduler  pod has unbound PersistentVolumeClaims (repeated 3 times)\n \n`}</code></pre>\n    <p>{`   Resolution:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`Change the storageclass to \"ibmc-file-gold\" and restart the deployment.\n`}</code></pre>\n    <p>{`  4 Stuck by wrong report information`}</p>\n    <p>{`  Log of the error:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`time=\"2019-09-04T20:11:23Z\" level=info msg=\"Values override output: global:\\\\n  architecture: amd64\\\\n  baseInstaller: false\\\\n  ibmProduct: zen\\\\n  userHomePVC:\\\\n    persistence:\\\\n      existingClaimName: \\\\\"\\\\\"\\\\n      size: 100Gi\\\\n  virtualIP: \\\\\"\\\\\"\\\\nimagemgmt:\\\\n  mgmtPlatform: openshift\\\\n  nodeSelector:\\\\n    compute: \\\\\"true\\\\\"\\\\nnginxRepo:\\\\n  resolver: kubernetes.default\\\\nusermgmt:\\\\n  showK8sMgmt: false\\\\nzenCoreApi:\\\\n  noTls: true\\\\n  tillerNamespace: zen\\\\nzenProxy:\\\\n  serviceType: ClusterIP\\\\nzenRedis:\\\\n  image:\\\\n    tag: '#REDIS_TAG#'\\\\n\"\ntime=\"2019-09-04T20:11:23Z\" level=info msg=\"Installing release zen-0015-setup\"\ntime=\"2019-09-04T20:11:57Z\" level=panic msg=\"Could not get the status of the release. Reason: rpc error: code = Unknown desc = getting deployed release \\\\\"zen-0015-setup\\\\\": release: \\\\\"zen-0015-setup\\\\\" not found\"\npanic: (*logrus.Entry) (0x176bd40,0xc00040afc0)goroutine 3405 [running]:\ngithub.com/sirupsen/logrus.Entry.log(0xc00009c240, 0xc0004e52c0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n/root/go/pkg/mod/github.com/sirupsen/logrus@v1.2.0/entry.go:216 +0x2ce\n`}</code></pre>\n    <p>{`  Resolution:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`Delete the installation pod.\n`}</code></pre>\n    <p>{` 5 Solr, Kafka and cassendra pods failed with similar message.`}</p>\n    <p>{`  Log of the error:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`[2019-09-04 21:38:20,833] ERROR Failed to create or validate data directory /var/lib/kafka/data (kafka.server.LogDirFailureChannel)\njava.io.IOException: Failed to create data directory /var/lib/kafka/data\nat kafka.log.LogManager$$anonfun$createAndValidateLogDirs$1.apply(LogManager.scala:158)\nat kafka.log.LogManager$$anonfun$createAndValidateLogDirs$1.apply(LogManager.scala:149)\nat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\nat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\nat kafka.log.LogManager.createAndValidateLogDirs(LogManager.scala:149)\nat kafka.log.LogManager.&lt;init>(LogManager.scala:80)\nat kafka.log.LogManager$.apply(LogManager.scala:990)\nat kafka.server.KafkaServer.startup(KafkaServer.scala:237)\nat kafka.server.KafkaServerStartable.startup(KafkaServerStartable.scala:38)\nat kafka.Kafka$.main(Kafka.scala:75)\nat kafka.Kafka.main(Kafka.scala)\n[2019-09-04 21:38:20,839] ERROR Shutdown broker because none of the specified log dirs from /var/lib/kafka/data can be created or validated (kafka.log.LogManager)\n`}</code></pre>\n    <p>{`  Resolution:`}</p>\n    <p>{`  Copy and run the follwing shell script and then run it by “./iisee-fix.sh zen”.`}</p>\n    <p>{`  `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.ibm.com/CASE/cloudpak-onboard-residency/blob/gh-pages/_content/data/iisee-fix.sh\"\n      }}>{`iisee-fix.sh`}</a></p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}