{"componentChunkName":"component---src-pages-content-data-install-add-on-vmware-md","path":"/content/data/install-add-on-vmware/","result":{"pageContext":{"frontmatter":{"title":"Install Add-Ons on Vmware OCP environment","weight":800},"relativePagePath":"/content/data/install-add-on-vmware.md","titleType":"page","MdxNode":{"id":"2868e967-555e-547c-b101-a1b58199247e","children":[],"parent":"c26f020e-64c1-52a0-a69a-45dd2e7f3ff0","internal":{"content":"---\ntitle: Install Add-Ons on Vmware OCP environment\nweight: 800\n---\n\n\n## Set Up the OpenShift Client CLI Tools and Access the Cluster\n\n1. If you haven't done so already, install the OpenShift client CLI tools using the directions at [here](https://cloud.ibm.com/docs/openshift?topic=openshift-openshift-cli).\n2. Login to the OpenShift console.  In the upper right hand side of the page, click on your user name and select \"Copy Login Command\".\n\n![LoginScreen](https://pages.github.ibm.com/CASE/cloudpak-onboard-residency/assets/img/cp4d/qijunlogin.jpg)\n\n3. Paste the command in a shell and a response will be returned with a list of projects and the current project selected.\n\n## Set Up the CP4D \"deploy.sh\" for Add-On Installation\n\n1. Retrieve the CP4D installer and only extract its contents using the \"--extract-only\" switch.  For example,\n_\"./installer.x86_64.520 --extract-only\"_\n2. The \"deploy.sh\" script that will be used later to install an add-on will be located at \"/ibm/InstallPackage/components/\".\n\n## Install helm and tiller\n\n1. Download helm tool\n\n       $ curl -s https://storage.googleapis.com/kubernetes-helm/helm-v2.9.1-linux-amd64.tar.gz | tar xz\n\n2. Copy the helm too to /bin directory\n\n       $ cp -f ./linux-amd64/helm /usr/local/bin/ /usr/bin/\n\n3. Check “helm” version\n\n       $ helm version\n\n4. Configure “helm” with OpenShift server\n\n\n       $ oc whoami - find the logged in user (1)\n       $ oc whoami –t - To find password (2)\n       $ oc get routes –n default àFind the docker registry url (3)\n       $ docker login –u openshift –u &lt;password> https://&lt;url from the command 3>\n\n5. List the deployed helm charts in the server\n\n       $oc get pods –all-namespacs | grep tiller\n       $ export TILLER_NAMESPACE=&lt;namespace> --> Namespace of the tiller running in Server $ helm list\n\n## Get the Add-On to be Installed\n\nFor this example, the \"Watson Machine Learning\" add-on tar will be used.  Download the add-on code and place it somewhere like \"/ibm/modules\"\n\n## Install the Add-On\n\n_\"./deploy.sh -o -d /ibm/modules/watson_machine_learning.tar\"_\n\n## Lesson Learn\n\nRunning \"helm list\" failed after \"helm version\" succeeded.\n\n```\n[root@res-cdoan-29918d73-master-01 ~]# helm list\nError: Get http://localhost:8080/api/v1/namespaces/zen/configmaps?labelSelector=OWNER%!D(MISSING)TILLER: dial tcp 127.0.0.1:8080: connect: connection refused\n[root@res-cdoan-29918d73-master-01 ~]#\n```\n\n Solution:\n   \n Step#1:\n\n```\n  oc --namespace=zen create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=zen:default\n  clusterrolebinding.rbac.authorization.k8s.io/add-on-cluster-admin created\n```\n Step#2:\n\n```\n  oc -n zen edit deployment  tiller-deploy\n```\n\n{% include figure.html src=\"/assets/img/cp4d/tiller-deploy-edit.png\" alt=\"Edit Tiller Deploy\" caption=\"Edit Tiller Deploy\" %}\n\n\n","type":"Mdx","contentDigest":"c416322c7b6c05eb5e492ca9108d099f","counter":141,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Install Add-Ons on Vmware OCP environment","weight":800},"exports":{},"rawBody":"---\ntitle: Install Add-Ons on Vmware OCP environment\nweight: 800\n---\n\n\n## Set Up the OpenShift Client CLI Tools and Access the Cluster\n\n1. If you haven't done so already, install the OpenShift client CLI tools using the directions at [here](https://cloud.ibm.com/docs/openshift?topic=openshift-openshift-cli).\n2. Login to the OpenShift console.  In the upper right hand side of the page, click on your user name and select \"Copy Login Command\".\n\n![LoginScreen](https://pages.github.ibm.com/CASE/cloudpak-onboard-residency/assets/img/cp4d/qijunlogin.jpg)\n\n3. Paste the command in a shell and a response will be returned with a list of projects and the current project selected.\n\n## Set Up the CP4D \"deploy.sh\" for Add-On Installation\n\n1. Retrieve the CP4D installer and only extract its contents using the \"--extract-only\" switch.  For example,\n_\"./installer.x86_64.520 --extract-only\"_\n2. The \"deploy.sh\" script that will be used later to install an add-on will be located at \"/ibm/InstallPackage/components/\".\n\n## Install helm and tiller\n\n1. Download helm tool\n\n       $ curl -s https://storage.googleapis.com/kubernetes-helm/helm-v2.9.1-linux-amd64.tar.gz | tar xz\n\n2. Copy the helm too to /bin directory\n\n       $ cp -f ./linux-amd64/helm /usr/local/bin/ /usr/bin/\n\n3. Check “helm” version\n\n       $ helm version\n\n4. Configure “helm” with OpenShift server\n\n\n       $ oc whoami - find the logged in user (1)\n       $ oc whoami –t - To find password (2)\n       $ oc get routes –n default àFind the docker registry url (3)\n       $ docker login –u openshift –u &lt;password> https://&lt;url from the command 3>\n\n5. List the deployed helm charts in the server\n\n       $oc get pods –all-namespacs | grep tiller\n       $ export TILLER_NAMESPACE=&lt;namespace> --> Namespace of the tiller running in Server $ helm list\n\n## Get the Add-On to be Installed\n\nFor this example, the \"Watson Machine Learning\" add-on tar will be used.  Download the add-on code and place it somewhere like \"/ibm/modules\"\n\n## Install the Add-On\n\n_\"./deploy.sh -o -d /ibm/modules/watson_machine_learning.tar\"_\n\n## Lesson Learn\n\nRunning \"helm list\" failed after \"helm version\" succeeded.\n\n```\n[root@res-cdoan-29918d73-master-01 ~]# helm list\nError: Get http://localhost:8080/api/v1/namespaces/zen/configmaps?labelSelector=OWNER%!D(MISSING)TILLER: dial tcp 127.0.0.1:8080: connect: connection refused\n[root@res-cdoan-29918d73-master-01 ~]#\n```\n\n Solution:\n   \n Step#1:\n\n```\n  oc --namespace=zen create clusterrolebinding add-on-cluster-admin --clusterrole=cluster-admin --serviceaccount=zen:default\n  clusterrolebinding.rbac.authorization.k8s.io/add-on-cluster-admin created\n```\n Step#2:\n\n```\n  oc -n zen edit deployment  tiller-deploy\n```\n\n{% include figure.html src=\"/assets/img/cp4d/tiller-deploy-edit.png\" alt=\"Edit Tiller Deploy\" caption=\"Edit Tiller Deploy\" %}\n\n\n","fileAbsolutePath":"/Users/Shared/VBDData/programs/cloudpak8s/src/pages/content/data/install-add-on-vmware.md"}}}}